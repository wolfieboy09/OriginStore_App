<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="stylesheet" href="/css/index.css">
    <canvas width="500" height="500"></canvas>
    <script src="/scripts/index.js" async></script>
    <script src="/scripts/background.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OriginStore | Main Page</title>
</head>
<body>
    
    <div class="title">
        <h1 id="title">OriginStore</h1>
        <div class="button-container">
            <button class="title_button" id="make_account">Create an account</button>
            <button class="title_button" id="login">Login</button>
        </div>
    </div>
    
    <div class="search-container">
        <input type="text" class="search-bar" placeholder="Search apps for OriginOS..." oninput="searchApps()">
    </div>
    
    <div class="cards" id="appList">
        <!-- App cards will be dynamically added here -->
    </div>
<script>
        // Function to render app cards based on the data
        function renderAppCards(apps) {
            const appListContainer = document.getElementById("appList");
            appListContainer.innerHTML = ""; // Clear existing app cards

            apps.forEach(app => {
                const card = document.createElement("div");
                card.classList.add("card");

                const name = document.createElement("h3");
                name.classList.add("card-name");
                name.textContent = app.name;

                const version = document.createElement("h3");
                version.classList.add("card-version");
                version.textContent = `Version: ${app.curr_ver}`;

                const requiredVersion = document.createElement("h3");
                requiredVersion.classList.add("card-required-version");
                requiredVersion.textContent = `Required Version: ${app.required_ver}`;

                const description = document.createElement("p");
                description.textContent = app.description;

                const viewButton = document.createElement("button");
                viewButton.classList.add("view-button");
                viewButton.textContent = "View App";

                card.appendChild(name);
                card.appendChild(version);
                card.appendChild(requiredVersion);
                card.appendChild(description);
                card.appendChild(viewButton);

                appListContainer.appendChild(card);
            });
        }

        // Function to perform search
        function searchApps() {
            const searchTerm = document.querySelector(".search-bar").value.toLowerCase();
            const filteredApps = apps.filter(app => app.name.toLowerCase().includes(searchTerm));
            renderAppCards(filteredApps);
        }

        // Fetch app data from the API
        fetch('https://origin-store-app-backend.onrender.com/applications', {
            method: "GET",
            mode: 'cors',
            headers: {
                'Content-Type': "application/json",
            }
        })
            .then(response => response.json())
            .then(data => {
                const apps = data.apps;
                renderAppCards(apps);
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
    
</body>
</html>
